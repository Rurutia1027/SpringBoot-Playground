# Understanding React Components' Lifetime

In React, components go through several phases during their lifetime, such as mounting, updating, and unmounting. Each phase corresponds to different lifecycle methods(for class components) or hooks(for functional components).

## First Render && Re-Render 
Before we continue, we need to clarify **Render First**, and **Re-Render** this two concepts. 
- **Render First**: the invoke order of render and **componentDidMount** is first, **Render First**, then **componentDidMount**.
- **What's Render First**: Render First or First Render is happened/triggered when you open the web page via given url address or try to refresh a web page. 
- **What's Re-Render**: Re-Render is happened or triggered by you try to interact with the already loaded web page by pressing some buttons or radios then we call it 're-render'.
And it is just like once we load the AST-tree's root into memory, as long as we do not play to re-start the program or re-establish the connection, to root always located in the memory space.  
But if we query some sub-blocks, sub-nodes that are not cached in memory or memory cached data already outdated, at this time 're-render' happend, it will re-fetch the disk file and load the refresh data from disk to memory and cache.
During re-render/re-query data and update cache this process the root node not modified, that's why we often said first-render only executed once(as long as we don't refresh the page). 

Then, after we handle the 'first render' this concept. It is easy to understand those two methods:
This is invoked before the `first render`

* `static getDerivedStateFromProps()`: this is called only once exactly before we invoke the first render, and it is always used to update derived props or stats as its name describes. 
* `componentDidMount()`: this is invoked exactly once after the first revoke(web page loading), and enables the React App obey the order of: 1. loading web page; 2. query/fetch datasets from backend endpoints; 3. integrate backend datasets with HTML tags(this is re-rendering). 


## 1. Mounting Phase 
This phase is when a component is created and inserted into the DOM for the first time. 

### Lifecycle methods for class components
* `constructor()`: Used to initialize state and bind methods. 
* `static getDerivedStateFromProps()`: Called before every render, used for state updates based on props. 
* `render()`: The method that actually outputs the JSX that will be rendered to the DOM. 
* `componentDidMount()`: Called after the component has been rendered to the DOM, often used for data fetching or subscriptions.

### Functional component hooks: 
* `useState()`: to set initial state.
* `useEffect()(with an empty dependency array[])`: This mimics `componentDidMount()` in functional components.  

### Example of Mounting(with componentDidMount() and useEffect()):

- **Class Component**

```jsx
class App extends React.Component {
    constructor(props) {
        // here constructor gets a props 
        // first hand over the props to the initialize function of App's parent class component
        // during parent class component there may be some key,value items parent component want to pass to child component
        // then, props will be inserted series of key,value items
        super(props);
        
        
        // when codes come here, we can fetch some data from props to pass them to this.state too
        // once data passed to the state, the state is modifed this modification triggers a 
        // re-render, and the render() below is the entry point of the re-render
        // in the re-render, we combined the fetch dataset with html tags
        // and finally those data will be converted into the html dom items shown on the web page. 
        this.state = {data: null}; 
    }
    
    componentDidMount() {
        fetch('https://api.example.com/fetch_data')
            .then(response => response.json())
            .then(data => this.setState({data})); 
    }
    
    // entry point of transforming memory data into DOM element
    // extract current scoped initialized data and integrated those data with HTML tags 
    // this is the entry point of re-render, and this re-render combined the 
    // the datasets that fetched via componentDidMount() function with the HTML taggs
    // and the combined items finally be converted into DOM elements to the web page 
    render() {
        return (
            <div>
                <h1>Data from API: </h1>
                <pre>{JSON.stringify(this.state.data, null, 2)}</pre>
            </div>
        ); 
    }
}
```
### Steps of the above code 
```text 
First Render(Initial Render): This is triggered after the constructor() is called during the mounting phase of the component lifecycle. 
React calls the render() method to produce the initial DOM representation of the component based on the state and props. 

Re-Render: A re-render happens whenever the state or props of the component changes. Initially, the data is null during the first render. Then after componentDidMount() fetches the data and calls setState, the state updates, triggering a re-render.  
```





## 2. Updating Phase 
## 3. Unmounting Phase 

## Summary of Component Lifecycle 
## Use Case for Lifecycle Methods 